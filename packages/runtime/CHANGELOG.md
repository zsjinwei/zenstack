# Changelog

## [2.0.0-alpha.3](https://github.com/zsjinwei/zenstack/compare/v2.0.0-alpha.2...v2.0.0-alpha.3) (2024-11-04)


### Features

* allow comparing fields from different models in mutation policies ([#1476](https://github.com/zsjinwei/zenstack/issues/1476)) ([6610bd0](https://github.com/zsjinwei/zenstack/commit/6610bd09f8d43b62b073044bb60a8a3cc40ef9e2))
* allow to pass in a custom `Prisma` module when calling `enhance` ([#1160](https://github.com/zsjinwei/zenstack/issues/1160)) ([018d59f](https://github.com/zsjinwei/zenstack/commit/018d59f58295cee4530b9650c49dc868251029dd))
* automatic optimistic update for tanstack hooks ([#830](https://github.com/zsjinwei/zenstack/issues/830)) ([93dc7df](https://github.com/zsjinwei/zenstack/commit/93dc7df472427a4546ba71ec3703135d2d638ded))
* **enhance:** Prisma Pulse support ([#1658](https://github.com/zsjinwei/zenstack/issues/1658)) ([32c258c](https://github.com/zsjinwei/zenstack/commit/32c258c120628d2742f90da4edd8e377a3e672e7))
* field-level policy override ([#889](https://github.com/zsjinwei/zenstack/issues/889)) ([271d568](https://github.com/zsjinwei/zenstack/commit/271d568ad3695e85f216ad7a293d9b9e802e7aaa))
* implementing permission checker ([#1411](https://github.com/zsjinwei/zenstack/issues/1411)) ([0aa6ee9](https://github.com/zsjinwei/zenstack/commit/0aa6ee961bab005705287184b670ae9a3a57f06d))
* improved automatic query invalidation for tanstack-query ([#790](https://github.com/zsjinwei/zenstack/issues/790)) ([42d654f](https://github.com/zsjinwei/zenstack/commit/42d654fcfaa40b09fde578db79792c69e1e3b908))
* make parameters of transactions configurable ([#988](https://github.com/zsjinwei/zenstack/issues/988)) ([d0745b1](https://github.com/zsjinwei/zenstack/commit/d0745b149a5ce6abfef546de0b9243ddc4f6e765))
* optimistic update support for SWR ([#860](https://github.com/zsjinwei/zenstack/issues/860)) ([0ca4670](https://github.com/zsjinwei/zenstack/commit/0ca46704f4c02b7d3e69470c68601835f426da59))
* RedwoodJS integration package ([#911](https://github.com/zsjinwei/zenstack/issues/911)) ([e4aeee3](https://github.com/zsjinwei/zenstack/commit/e4aeee32ae3a5ab1718fd1daa2f93043fb68a8d5))
* **redwood:** redwood v7 support ([#1617](https://github.com/zsjinwei/zenstack/issues/1617)) ([3831350](https://github.com/zsjinwei/zenstack/commit/3831350b2eff1a91287c1170aa3b3c8bab0c8955))
* runtime support for custom `@[@auth](https://github.com/auth)` model ([#793](https://github.com/zsjinwei/zenstack/issues/793)) ([08b9677](https://github.com/zsjinwei/zenstack/commit/08b967735c938de1e770a2409c36c5a50173b01d))
* **runtime:** support for Prisma 5.14's `createManyAndReturn` ([#1479](https://github.com/zsjinwei/zenstack/issues/1479)) ([a783800](https://github.com/zsjinwei/zenstack/commit/a7838000ba509db6191c7ed93329eaaa02325692))
* support using collection predicate expression with `auth()` ([#831](https://github.com/zsjinwei/zenstack/issues/831)) ([ff1e8a5](https://github.com/zsjinwei/zenstack/commit/ff1e8a5e98ec94337f08576a29ffbee07ba8fd88))


### Bug Fixes

* '[@password](https://github.com/password)' attribute doesn't work well with data validation ([#1547](https://github.com/zsjinwei/zenstack/issues/1547)) ([9294f04](https://github.com/zsjinwei/zenstack/commit/9294f04d4f0befba586e2f20a088707090724080))
* [@omit](https://github.com/omit) doesn't remove fields inside to-many relation ([#993](https://github.com/zsjinwei/zenstack/issues/993)) ([a4d3f15](https://github.com/zsjinwei/zenstack/commit/a4d3f15746269257bc7fb56332766e3f598e2996))
* `createManyAndReturn` doesn't work  for polymorphic models ([#1590](https://github.com/zsjinwei/zenstack/issues/1590)) ([8438e2b](https://github.com/zsjinwei/zenstack/commit/8438e2b4f7e1517d0f0f0682c5b400559afd66d6))
* add missing auth export ([#1449](https://github.com/zsjinwei/zenstack/issues/1449)) ([81a2adf](https://github.com/zsjinwei/zenstack/commit/81a2adfe43c958ffe1645d24bcfb119a3daf8edd))
* additional fixes for unique constraint conflict detection ([#1165](https://github.com/zsjinwei/zenstack/issues/1165)) ([9f89c7e](https://github.com/zsjinwei/zenstack/commit/9f89c7ea76adfa73406843e3c2f222ea0bfcb969))
* bug in enhancement proxy for detecting nested transactions ([#941](https://github.com/zsjinwei/zenstack/issues/941)) ([85a0525](https://github.com/zsjinwei/zenstack/commit/85a052594c447120ecc8123d30c7b098afcc8841))
* bug with NOT clause reduction when condition is an array ([#848](https://github.com/zsjinwei/zenstack/issues/848)) ([debd35b](https://github.com/zsjinwei/zenstack/commit/debd35b3531262c4df453653cbee10dc85baf222))
* build, lint and etc. ([#833](https://github.com/zsjinwei/zenstack/issues/833)) ([cccbc3c](https://github.com/zsjinwei/zenstack/commit/cccbc3c82ad522d40bc76ad7b84b1305d378b1db))
* clean up zod generation ([#883](https://github.com/zsjinwei/zenstack/issues/883)) ([909281f](https://github.com/zsjinwei/zenstack/commit/909281f8090734322c0cab09d0187b6b5e813c9a))
* clean up zod generation ([#883](https://github.com/zsjinwei/zenstack/issues/883)) ([9d4a8ed](https://github.com/zsjinwei/zenstack/commit/9d4a8ede7d42d1966fd5a12d64a5992092f4bc7d))
* compatibility with Prisma's "omit" feature ([#1432](https://github.com/zsjinwei/zenstack/issues/1432)) ([296ca25](https://github.com/zsjinwei/zenstack/commit/296ca259c8dd3e38fa988378df4a9e351a11b20b))
* deal with payload field value with undefined ([#778](https://github.com/zsjinwei/zenstack/issues/778)) ([e41fc74](https://github.com/zsjinwei/zenstack/commit/e41fc747c5a8389d820820c5f8fd95ee13717160))
* **delegate:** `[@omit](https://github.com/omit)` and field-level policies are not enforced when querying with a delegate model ([#1718](https://github.com/zsjinwei/zenstack/issues/1718)) ([57652a1](https://github.com/zsjinwei/zenstack/commit/57652a1831ff79ce923cb808214762791aaca899))
* **delegate:** avoid merging into object of Decimal, Date, etc. ([#1489](https://github.com/zsjinwei/zenstack/issues/1489)) ([ab9d27f](https://github.com/zsjinwei/zenstack/commit/ab9d27f669388764139eb42caeef1bb9f19c7524))
* **delegate:** base fields not properly wrapped inside relation layer when injected from policies ([#1736](https://github.com/zsjinwei/zenstack/issues/1736)) ([bfe6983](https://github.com/zsjinwei/zenstack/commit/bfe698390c689dbe4350f7989cc6a1974ff1aad5))
* **delegate:** concrete model fields are not properly included if queried from a nested context from a parent concrete model ([ab261ae](https://github.com/zsjinwei/zenstack/commit/ab261aed8fd79491250901ecf6e4999456700cea)), closes [#1968](https://github.com/zsjinwei/zenstack/issues/1968)
* **delegate:** concrete model fields are not properly included if queried from a nested context from a parent concrete model ([#1700](https://github.com/zsjinwei/zenstack/issues/1700)) ([8b56d7d](https://github.com/zsjinwei/zenstack/commit/8b56d7da2739220830b5cbe1ddc574726f0d2f41))
* **delegate:** delegate models returned in nested results don't include base fields ([#1662](https://github.com/zsjinwei/zenstack/issues/1662)) ([8589b79](https://github.com/zsjinwei/zenstack/commit/8589b79b66cd5b5be6d37440fc7b4924bac1d056))
* **delegate:** enforcing concrete model policies when read from a delegate base ([#1726](https://github.com/zsjinwei/zenstack/issues/1726)) ([738bba6](https://github.com/zsjinwei/zenstack/commit/738bba6ef1edcd36c576df66a268b63d00741f2b))
* **delegate:** fields from delegate models used in logical groups inside filter are not translated ([#1418](https://github.com/zsjinwei/zenstack/issues/1418)) ([1243422](https://github.com/zsjinwei/zenstack/commit/12434220a5328ec3885a35f7fc1481788fc536e2))
* **delegate:** make sure concrete fields are included when a polymorphic model field is included in deep nesting ([#1524](https://github.com/zsjinwei/zenstack/issues/1524)) ([b34531d](https://github.com/zsjinwei/zenstack/commit/b34531dcd47b875aae083d1a820aa896f3766c8b))
* **delegate:** make sure nested `createMany` is converted into regular `create` ([#1526](https://github.com/zsjinwei/zenstack/issues/1526)) ([3e77974](https://github.com/zsjinwei/zenstack/commit/3e77974c74cb33496d9568fa1d95727449e18522))
* **delegate:** null reference when reading an optional relation ([#1491](https://github.com/zsjinwei/zenstack/issues/1491)) ([41880f3](https://github.com/zsjinwei/zenstack/commit/41880f38d2ee71545aa2ce9f2e6ac8f5575c717d))
* **delegate:** policies inherited from delegate base models are not injected into proper hierarchy ([#1776](https://github.com/zsjinwei/zenstack/issues/1776)) ([4f00cf1](https://github.com/zsjinwei/zenstack/commit/4f00cf12584e59a59ac2a40df1b6e944d15ff3fa))
* **delegate:** push base-level id assignment to base payload when creating a concrete entity ([#1521](https://github.com/zsjinwei/zenstack/issues/1521)) ([a14bf29](https://github.com/zsjinwei/zenstack/commit/a14bf29de4d903c0a226a1604991dd760cbf8614))
* enhanced client doesn't work with client extensions that add new model methods ([7dec167](https://github.com/zsjinwei/zenstack/commit/7dec167b8c3bb03c3cae57e6566b223bfce57cca))
* enhanced client doesn't work with client extensions that add new model methods ([#851](https://github.com/zsjinwei/zenstack/issues/851)) ([ea564c9](https://github.com/zsjinwei/zenstack/commit/ea564c93e9ca2a888c0e53216633d66c733f6beb))
* field with read-deny can be used to filter due to a prisma bug ([#1728](https://github.com/zsjinwei/zenstack/issues/1728)) ([b8d8902](https://github.com/zsjinwei/zenstack/commit/b8d890293e9336d7571d5c5afe0ae5733d880d86))
* field-level policy should filter out records when the field used for filtering is not allowed to read ([#1661](https://github.com/zsjinwei/zenstack/issues/1661)) ([19a3b5d](https://github.com/zsjinwei/zenstack/commit/19a3b5dcafe59cbad1ada91b5f2d2b9730623ccf))
* handle foreign key field-level access check during relation update ([#847](https://github.com/zsjinwei/zenstack/issues/847)) ([3c8cba7](https://github.com/zsjinwei/zenstack/commit/3c8cba71b283d6029087971fc3b160892d0d143e))
* **hooks:** support optimistic update for "upsert" ([#1767](https://github.com/zsjinwei/zenstack/issues/1767)) ([374e962](https://github.com/zsjinwei/zenstack/commit/374e9627bf3fc7db67896d0fd83590f0d5657b0a))
* incorrect cross-model comparision for && and || expressions ([#1512](https://github.com/zsjinwei/zenstack/issues/1512)) ([908048b](https://github.com/zsjinwei/zenstack/commit/908048b01430ff6552e8df558d5b5905136ea5cc))
* incorrect policy injection for nested to-one relation inside a to-many parent ([#777](https://github.com/zsjinwei/zenstack/issues/777)) ([876e013](https://github.com/zsjinwei/zenstack/commit/876e01392112ed369cde37cb77ca983126f2d881))
* incorrect prisma query executed when count using a where filter involving a polymorphic base field ([#1586](https://github.com/zsjinwei/zenstack/issues/1586)) ([3140d9b](https://github.com/zsjinwei/zenstack/commit/3140d9bee91171665a8f1f69b8939a38643f9cb1))
* incorrect reverse query built for to-many relation ([d2ad3a5](https://github.com/zsjinwei/zenstack/commit/d2ad3a59f93a74189c29d3ee2960fc887b14851c))
* incorrect reverse query built for to-many relation ([#815](https://github.com/zsjinwei/zenstack/issues/815)) ([2c345e1](https://github.com/zsjinwei/zenstack/commit/2c345e1d4fe7274b7a08c1178afccede1d694327))
* infinite recursion when injecting field selection for field-level permission check ([#1452](https://github.com/zsjinwei/zenstack/issues/1452)) ([29962e0](https://github.com/zsjinwei/zenstack/commit/29962e0b48a73ae6d42f43f2575048ba9cf6a953))
* issue 961, incorrect policy injection for nested `updateMany` ([bf690a0](https://github.com/zsjinwei/zenstack/commit/bf690a072771ab95907a8f56079c4f6aaf655849))
* issue 961, incorrect policy injection for nested `updateMany` ([#962](https://github.com/zsjinwei/zenstack/issues/962)) ([2b2bfcf](https://github.com/zsjinwei/zenstack/commit/2b2bfcff965f9a70ff2764e6fbc7613b6f061685))
* issues with cross-model comparison identification and injection ([#1508](https://github.com/zsjinwei/zenstack/issues/1508)) ([665f9b3](https://github.com/zsjinwei/zenstack/commit/665f9b33b58acc5170c4ccb8e73be525fbb89734))
* more robust custom serializer ([#1689](https://github.com/zsjinwei/zenstack/issues/1689)) ([b421047](https://github.com/zsjinwei/zenstack/commit/b421047d945a2744a67a26e9e568a91899d35d67))
* nested `createMany` with `skipDuplicates` option is not handled correctly ([#1163](https://github.com/zsjinwei/zenstack/issues/1163)) ([fef6e83](https://github.com/zsjinwei/zenstack/commit/fef6e83a36f451f671ac2b7db1bc06e2e29faf43))
* **policy:** field-level override rules don't work properly with non-optional to-one relations ([#1592](https://github.com/zsjinwei/zenstack/issues/1592)) ([050f760](https://github.com/zsjinwei/zenstack/commit/050f7600f59c7d9e02e18cfe25545ae737c2bdba))
* **policy:** properly handle array-form of upsert payload ([#1101](https://github.com/zsjinwei/zenstack/issues/1101)) ([e7e1873](https://github.com/zsjinwei/zenstack/commit/e7e1873744ac2d48e118ae48b23e10723d16db44))
* **policy:** relation filter should respect field-level policies ([#1495](https://github.com/zsjinwei/zenstack/issues/1495)) ([54e1e02](https://github.com/zsjinwei/zenstack/commit/54e1e02839c4f010e21fa50c48289f872d8ae0eb))
* post-update rule for id field is not effective if id is updated ([#1237](https://github.com/zsjinwei/zenstack/issues/1237)) ([5fe85ff](https://github.com/zsjinwei/zenstack/commit/5fe85ffa50d012c65db542602448d5522b71ef9b))
* post-update rules incorrectly reject update ([#826](https://github.com/zsjinwei/zenstack/issues/826)) ([d921a7c](https://github.com/zsjinwei/zenstack/commit/d921a7ca6bef0341ccf5bc50e195156695129e7f))
* post-update rules incorrectly reject update ([#826](https://github.com/zsjinwei/zenstack/issues/826)) ([e85831e](https://github.com/zsjinwei/zenstack/commit/e85831e98d08a433febb5a8fecf8d539150ced08))
* query injection error when create (in array form) is nested inside an update ([#865](https://github.com/zsjinwei/zenstack/issues/865)) ([ca55bf6](https://github.com/zsjinwei/zenstack/commit/ca55bf61edff7a67765cd8a9eac2b97daaf33506))
* **redwood:** fix incorrect error type thrown ([#1659](https://github.com/zsjinwei/zenstack/issues/1659)) ([1d81325](https://github.com/zsjinwei/zenstack/commit/1d81325696076038483a3c30a93962d0d91afb23))
* relation fields are included even if they are set `false` in select clause ([#1429](https://github.com/zsjinwei/zenstack/issues/1429)) ([6a71742](https://github.com/zsjinwei/zenstack/commit/6a717428d3d0176eb3651b488fe0660895dab14d))
* **runtime:** always use id fields to address existing entity during upsert ([#1273](https://github.com/zsjinwei/zenstack/issues/1273)) ([d8c1513](https://github.com/zsjinwei/zenstack/commit/d8c15135a7edb75b459b6f5f1736e5fa2d96a9fa))
* **runtime:** avoid duplicating non-plain objects ([#1545](https://github.com/zsjinwei/zenstack/issues/1545)) ([ba2a113](https://github.com/zsjinwei/zenstack/commit/ba2a113126bad4f2719e60b0a6b23df4125a562d))
* **runtime:** improved query reduction to workaround Prisma issue prisma/prisma[#21856](https://github.com/zsjinwei/zenstack/issues/21856) ([#1634](https://github.com/zsjinwei/zenstack/issues/1634)) ([179634e](https://github.com/zsjinwei/zenstack/commit/179634ebd6f2ebac750ccb80eb9dd0a0e1f093fc))
* should not reject "update" when there's only field-level override but no model-level policy ([#1052](https://github.com/zsjinwei/zenstack/issues/1052)) ([912c831](https://github.com/zsjinwei/zenstack/commit/912c83176a57ae2e2397c0aab68c0299a6115025))
* support for Prisma 5.16.0 ([#1541](https://github.com/zsjinwei/zenstack/issues/1541)) ([0a293ca](https://github.com/zsjinwei/zenstack/commit/0a293ca0afebee621848463e05408a39dfa934e2))
* supports for complex usage of "@[@index](https://github.com/index)" in zmodel ([#995](https://github.com/zsjinwei/zenstack/issues/995)) ([541cd97](https://github.com/zsjinwei/zenstack/commit/541cd973081cbbf2d9e2e571ee8f971bc859150c))
* tanstack-query build issues and bugs in optimistic update ([#843](https://github.com/zsjinwei/zenstack/issues/843)) ([08d317d](https://github.com/zsjinwei/zenstack/commit/08d317d150b99fc38b8e5fb56bb4ab27fe1b4470))
* **tanstack:** incorrect InfiniteData import for vue-query ([#1498](https://github.com/zsjinwei/zenstack/issues/1498)) ([92f187f](https://github.com/zsjinwei/zenstack/commit/92f187f9190517df5baca795f12386c12c6694e9))
* unintended changes to "backlink" of abstract model's metadata ([#1691](https://github.com/zsjinwei/zenstack/issues/1691)) ([9e93985](https://github.com/zsjinwei/zenstack/commit/9e93985589abc4d22eba433b7927193b4fd405a6))
* use zod parse result data as mutation input ([#997](https://github.com/zsjinwei/zenstack/issues/997)) ([613ac8d](https://github.com/zsjinwei/zenstack/commit/613ac8d2cd638272bcc7b24e0fb96e60c0d43acc))
* using `auth()` in `[@default](https://github.com/default)()` is not effective for `createManyAndReturn` ([#1727](https://github.com/zsjinwei/zenstack/issues/1727)) ([64198a3](https://github.com/zsjinwei/zenstack/commit/64198a3e2dd838b3ac81f48e639716d4ec773d69))
* validate zod schema before update operation is executed ([#1051](https://github.com/zsjinwei/zenstack/issues/1051)) ([9db52db](https://github.com/zsjinwei/zenstack/commit/9db52dbb77650d7c99380308803b7b4b4b7ae42d))
* when field policy only has deny rule, access should be allowed when the rule doesn't satisfy ([#818](https://github.com/zsjinwei/zenstack/issues/818)) ([62a8200](https://github.com/zsjinwei/zenstack/commit/62a82001cde1c8e0ac598035b8df77b9049fabaa))
* **zod:** "strip" mode causes create payload fields to be accidentally dropped ([#1747](https://github.com/zsjinwei/zenstack/issues/1747)) ([b3b1130](https://github.com/zsjinwei/zenstack/commit/b3b1130b88728853707494c40fcdeb7182235027))

## [2.0.0-alpha.2](https://github.com/zenstackhq/zenstack/compare/v2.0.0-alpha.1...v2.0.0-alpha.2) (2024-02-21)


### Miscellaneous Chores

* release 2.0.0-alpha.2 ([f40d7e3](https://github.com/zenstackhq/zenstack/commit/f40d7e3718d4210137a2e131d28b5491d065b914))
